title = "Security Rules"
load-default = true  # Keeps built-in rules

[[rules]]
id = "custom-api-key"  # Required field
description = "Custom API Key Pattern"
regex = '''(?i)(?:key|api|token|secret)[\s:=]+([a-z0-9\-_]{20,})'''
tags = ["key", "api-key"]

# Add an allowlist to ignore env var placeholders or safe patterns
[allowlist]
description = "Ignore environment variable placeholders and Pulumi secret commands"
regexes = [
	pattern1 = '''\$SERVICE_ACCOUNT_KEY'''  # Ignore $SERVICE_ACCOUNT_KEY
	pattern2 = '''pulumi config set --secret'''  # Ignore Pulumi secret commands
]